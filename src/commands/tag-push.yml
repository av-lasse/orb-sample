description: Tag Docker images and push to ECR registry
parameters:
  ecr-registry:
    type: string
    default: '534003348933.dkr.ecr.eu-west-1.amazonaws.com'
  service:
    type: string
    default: ''
  pull-tag:
    type: string
    default: ''
  push-tag:
    type: string
    default: 'latest'

steps:
  - run:
      name: Pull image for tagging
      command: |
        docker pull "${ecr-registry}/${service}:${pull-tag}"
  - run:
      name: Tag image
      command: |
        docker tag "${ecr-registry}"/"${service}:${pull-tag}" "${ecr-registry}"/"${service}:${push-tag}" 
  - run:
      name: Tag image
      command: |
        docker push "${ecr-registry}"/"${service}:${push-tag}" 

